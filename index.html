<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>Slytherin Field Guide: The Complete Edition</title>
    <style>
        /* æè‡´ã€Šéœæ ¼æ²ƒèŒ¨ä¹‹é—ã€‹UI é£æ ¼ */
        body {
            background: #0a0f0d; 
            font-family: "Georgia", "Times New Roman", "å®‹ä½“", serif;
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            color: #ccc;
        }

        #logContainer {
            width: 28%;
            display: flex;
            flex-direction: column;
            height: 94vh;
        }

        #loginSection {
            display: flex;
            justify-content: center;
            gap: 8px;
            background: linear-gradient(180deg, #1a472a 0%, #0d2616 100%); 
            border: 1px solid #aaa9ad; 
            color: #fff;
            padding: 12px;
            border-radius: 12px 12px 0 0;
        }

        #tipBox {
            flex-grow: 1;
            background: #0d1a12;
            border: 2px solid #2a623d;
            border-top: none;
            border-radius: 0 0 12px 12px;
            padding: 15px;
            color: #9dbf9d;
            line-height: 1.7;
            font-size: 14px;
            box-shadow: inset 0 0 20px #000;
            overflow-y: auto;
        }

        .achievement-text { color: #d4af37; font-weight: bold; text-shadow: 0 0 5px rgba(212, 175, 55, 0.5); }

        #main {
            width: 65%;
            margin-left: 25px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            height: 94vh;
            overflow-y: scroll; 
            padding-right: 15px;
        }

        #main::-webkit-scrollbar, #tipBox::-webkit-scrollbar { width: 0px; }
        #main, #tipBox { scrollbar-width: none; }

        button {
            background: #2a623d;
            color: #eee;
            border: 1px solid #aaa9ad;
            padding: 5px 12px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 11px;
            text-transform: uppercase;
            margin: 2px;
        }

        button:hover { background: #1a472a; color: #fff; box-shadow: 0 0 10px #5d8a6a; }

        .section {
            background: #161d18;
            border: 1px solid #2a623d;
            border-radius: 8px;
            padding: 12px;
            flex-shrink: 0;
        }

        #scoreBoard {
            font-weight: bold;
            color: #aaa9ad;
            font-size: 1.3em;
            text-shadow: 2px 2px 4px #000;
            padding-bottom: 5px;
            border-bottom: 1px solid #2a623d;
        }

        #attrBoard {
            background: rgba(13, 20, 16, 0.9);
            border: 1px solid #aaa9ad;
            border-radius: 12px;
            padding: 12px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        .attr-line {
            display: flex;
            justify-content: space-between;
            padding: 3px 8px;
            border-bottom: 1px solid #1a3022;
            font-size: 13px;
            color: #9dbf9d;
        }

        .goal-task {
            background: linear-gradient(90deg, #0a1f13 0%, #161d18 100%);
            border-left: 5px solid #1a472a;
            padding: 15px;
            border-radius: 0 8px 8px 0;
            transition: all 1s ease;
        }

        .goal-task.completed {
            background: linear-gradient(90deg, #2c240a 0%, #161d18 100%);
            border-left: 5px solid #d4af37;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.3);
        }

        .goal-task.completed h4 { color: #d4af37; border-left-color: #d4af37; }

        h3, h4 {
            margin: 0 0 8px;
            color: #5d8a6a;
            border-left: 4px solid #aaa9ad;
            padding-left: 10px;
            font-size: 15px;
            text-transform: uppercase;
        }

        .progress-text { color: #fff; font-size: 12px; font-family: "Courier New", Courier, monospace; }

        input, select { background: #0d1410; color: #ccc; border: 1px solid #2a623d; padding: 5px; border-radius: 4px; font-size: 12px; }
        .time-input { width: 45px; text-align: center; }
        .description-text { color: #7a8c7a; font-size: 12px; font-style: italic; margin-bottom: 8px; display: block; }
    </style>
</head>
<body>

<div id="logContainer">
    <div id="loginSection">
        <button onclick="addTip('å®æˆ˜æŒ‡å—å¥‘çº¦å·²åŒæ­¥ã€‚')">ç­¾è®¢å¥‘çº¦</button>
        <button onclick="saveData()">é•Œåˆ»è¿›åº¦</button>
    </div>
    <div id="tipBox"></div>
</div>

<div id="main">
    <div id="scoreBoard">ç­‰çº§: <span id="rankName">è›‡é™¢æ–°ç”Ÿ</span> | æ”¶è—è¿›åº¦: <span id="totalPoints">0</span></div>
    
    <div id="attrBoard" class="section">
        <div class="attr-line"><span>ğŸ§ª ç§˜æ³•:</span><span id="wisdomVal">0</span></div>
        <div class="attr-line"><span>ğŸ é›„å¿ƒ:</span><span id="willVal">0</span></div>
        <div class="attr-line"><span>â™Ÿï¸ åŸåºœ:</span><span id="mindVal">0</span></div>
        <div class="attr-line"><span>ğŸ’ ä»ªæ€:</span><span id="tidinessVal">0</span></div>
        <div class="attr-line"><span>ğŸ—¡ï¸ éŸ§æ€§:</span><span id="staminaVal">0</span></div>
        <div class="attr-line"><span>ğŸ©¸ è¡€ç»Ÿ:</span><span id="healthVal">0</span></div>
    </div>

    <div id="chineseGoalCard" class="goal-task">
        <h4>æŒ‘æˆ˜ï¼šçº¯è¡€è‰ºæœ¯çš„å¤å…´</h4>
        <span class="description-text">ä¸ºäº†å®¶æ—çš„æŒ¯å…´ï¼Œä½ å¿…é¡»åœ¨å¤è€çš„é­”æ³•è‰ºæœ¯ä¸­å±•ç°å‡ºå“è¶Šçš„å¤©èµ‹ã€‚</span>
        <div id="chineseMedGoalDisplay" class="progress-text">è¿›åº¦: 0.0 / 100</div>
    </div>

    <div id="westernGoalCard" class="goal-task">
        <h4>æŒ‘æˆ˜ï¼šé»‘é­”æ³•é˜²å¾¡é€ è¯£</h4>
        <span class="description-text">åŠ›é‡æœ¬èº«å¹¶æ— å–„æ¶ã€‚ä½ æ¸´æœ›æŒæ¡é‚£äº›è¢«è§†ä¸ºç¦å¿Œçš„å’’è¯­ã€‚</span>
        <div id="westernMedGoalDisplay" class="progress-text">è¿›åº¦: 0.0 / 100</div>
    </div>

    <div class="section">
        <h3>ğŸ“š è¯¾ç¨‹é’»ç ” (Classroom)</h3>
        <select id="subject">
            <option value="base">å¤ä»£å¦‚å°¼æ–‡ (ä¸­åŸº)</option>
            <option value="west">é»‘é­”æ³•é˜²å¾¡æœ¯ (è¥¿åŒ»)</option>
            <option value="potions">é«˜çº§é­”è¯å­¦ (æ–¹å‰‚)</option>
        </select>
        <input id="studyH" class="time-input" type="number" placeholder="H"> æ—¶ 
        <input id="studyM" class="time-input" type="number" placeholder="M"> åˆ†
        <button onclick="study()">æŠ•èº«ç ”ç©¶</button>
    </div>

    <div class="section">
        <h3>ğŸ“• ç¦ä¹¦åŒºç ”è¯» (Restricted Section)</h3>
        <input id="restrictH" class="time-input" type="number" placeholder="H"> æ—¶ 
        <input id="restrictM" class="time-input" type="number" placeholder="M"> åˆ†
        <button onclick="restrictStudy()">ç§˜å¯†æ½œå…¥</button>
    </div>

    <div class="section">
        <h3>ğŸ•¯ï¸ å’’è¯­åŸè¯µ (Rituals)</h3>
        <input id="chantH" class="time-input" type="number" placeholder="H"> æ—¶ 
        <input id="chantM" class="time-input" type="number" placeholder="M"> åˆ†
        <button onclick="chant()">å¼€å¯å†¥æƒ³</button>
    </div>

    <div class="section">
        <h3>ğŸ· è¿›é¤å›å¤ (Refection)</h3>
        <button onclick="eat(1.5, 'é•¿æ¡Œæ™šå®´çš„å…»åˆ†è®©ä½ çš„é­”åŠ›å¾—åˆ°äº†å……åˆ†è¡¥å……ã€‚')">é•¿æ¡Œæ™šå®´</button>
        <button onclick="eat(-2, 'å¹³åº¸é£Ÿç‰©çš„å½±å“è®©ä½ æ„Ÿè§‰æœ‰äº›ä¸é€‚ã€‚')">è·¯è¾¹éº»ç“œé£Ÿç‰©</button>
    </div>

    <div class="section">
        <h3>âš”ï¸ æˆ˜æŠ€ç»ƒä¹  (Combat)</h3>
        <input id="combatH" class="time-input" type="number" placeholder="H"> æ—¶ 
        <input id="combatM" class="time-input" type="number" placeholder="M"> åˆ†
        <button onclick="exercise('å†³æ–—ä¿±ä¹éƒ¨è®­ç»ƒ')">å†³æ–—è®­ç»ƒ</button>
        <button onclick="exercise('é­åœ°å¥‡é£è¡Œè®­ç»ƒ')">é£è¡Œè®­ç»ƒ</button>
        <button onclick="exercise('ä¼˜é›…ç¤¾äº¤èˆæ­¥')">ç¤¾äº¤èˆæ­¥</button>
    </div>

    <div class="section">
        <h3>ğŸ° åœ°ç‰¢æ—¥å¸¸ä¸ä»ªå®¹</h3>
        <button onclick="daily('stamina', 5, 'åœ¨å¯å®¤çš„é™è°§ä¸­å®Œæˆäº†é­”åŠ›é‡å¡‘ã€‚')">ğŸ›Œ åœ°ç‰¢æ·±åº¦ä¼‘æ†©</button>
        <button onclick="daily('tidiness', 3, 'æ¸…æ´å’’è¯­ (Scourgify) è®©ä¸€åˆ‡ç„•ç„¶ä¸€æ–°ã€‚')">ğŸ§¹ æ‰«é™¤å‡Œä¹±</button>
        <button onclick="daily('tidiness', 2.5, 'çº§é•¿æµ´å®¤çš„è’¸æ±½å¯ä»¥èˆ’ç¼“é•¿æœŸçš„ç–²åŠ³ã€‚')">ğŸ› æ²æµ´çº§é•¿æµ´å®¤</button>
        <button onclick="daily('tidiness', 1.5, 'é¢†å¸¦çš„è§’åº¦ä½“ç°äº†ä¸€ä¸ªçº¯è¡€å·«å¸ˆçš„ä¿®å…»ã€‚')">æ•´ç†ä¸ç»¸é¢†å¸¦</button>
    </div>

    <div style="height: 50px;"></div>
</div>

<script>
    window.attr = { health: 10, stamina: 10, tidiness: 10, will: 10, mind: 10, wisdom: 10 };
    window.goal = { westernMedHours: 0, chineseMedHours: 0 };
    window.achievements = { chinese: false, western: false };

    function addTip(text, isAchievement = false) {
        const p = document.createElement('div');
        if (isAchievement) p.className = 'achievement-text';
        p.innerText = `>> ${text}`;
        document.getElementById('tipBox').prepend(p);
    }

    function updateDisplay() {
        for (let key in window.attr) {
            document.getElementById(key + 'Val').innerText = window.attr[key].toFixed(1);
        }
        document.getElementById('chineseMedGoalDisplay').innerText = `è¿›åº¦: ${Math.min(100, window.goal.chineseMedHours).toFixed(1)} / 100`;
        document.getElementById('westernMedGoalDisplay').innerText = `è¿›åº¦: ${Math.min(100, window.goal.westernMedHours).toFixed(1)} / 100`;
        
        const total = Object.values(window.attr).reduce((a, b) => a + b, 0);
        let rank = "è›‡é™¢æ–°ç”Ÿ";
        if(total > 150) rank = "çº¯è¡€ç»§æ‰¿äºº";
        if(total > 400) rank = "å¤ä»£é­”æ³•å¤§å¸ˆ";
        document.getElementById('rankName').innerText = rank;
        document.getElementById('totalPoints').innerText = Math.round(total);
        checkAchievements();
    }

    function checkAchievements() {
        if (!window.achievements.chinese && window.goal.chineseMedHours >= 100) {
            window.achievements.chinese = true;
            document.getElementById('chineseGoalCard').classList.add('completed');
            addTip('ã€æŒ‘æˆ˜è¾¾æˆã€‘ä½ å·²è§‰é†’å¤ä»£é­”æ³•ï¼Œå…¨å±æ€§ +5ï¼', true);
            for (let key in window.attr) window.attr[key] += 5;
        }
        if (!window.achievements.western && window.goal.westernMedHours >= 100) {
            window.achievements.western = true;
            document.getElementById('westernGoalCard').classList.add('completed');
            addTip('ã€æŒ‘æˆ˜è¾¾æˆã€‘ä½ å·²æ´æ‚‰ç¦å¿ŒåŠ›é‡ï¼Œå…¨å±æ€§ +5ï¼', true);
            for (let key in window.attr) window.attr[key] += 5;
        }
    }

    function getTime(hId, mId) {
        let h = parseFloat(document.getElementById(hId).value) || 0;
        let m = parseFloat(document.getElementById(mId).value) || 0;
        return h + (m / 60);
    }

    function study() {
        let t = getTime('studyH', 'studyM');
        if(t <= 0) return;
        window.attr.wisdom += t * 2.5; window.attr.stamina -= t * 1.5;
        if(document.getElementById('subject').value === 'west') window.goal.westernMedHours += t;
        else window.goal.chineseMedHours += t;
        addTip(`æŠ•èº«è¯¾ç¨‹é’»ç ”ï¼Œå®æˆ˜æŒ‡å—è¯æ¡å·²æ›´æ–°ã€‚`);
        updateDisplay();
    }

    function restrictStudy() {
        let t = getTime('restrictH', 'restrictM');
        if(t <= 0) return;
        window.attr.wisdom += t * 3.5; window.attr.mind += t * 2.0; window.attr.stamina -= t * 2.5;
        window.goal.chineseMedHours += t;
        addTip(`åœ¨ç¦ä¹¦åŒºæ±²å–äº†è¢«å°˜å°çš„å¤è€æ™ºæ…§ã€‚`);
        updateDisplay();
    }

    function chant() {
        let t = getTime('chantH', 'chantM');
        if(t <= 0) return;
        window.attr.will += t * 3.0; window.attr.wisdom += t * 1.0;
        window.goal.chineseMedHours += t * 0.5;
        addTip(`å¤è€çš„åŸè¯µåœ¨è€³ç•”å›å“ï¼Œæ„å¿—å¾—åˆ°äº†æ·¬ç‚¼ã€‚`);
        updateDisplay();
    }

    function exercise(msg) {
        let t = getTime('combatH', 'combatM');
        if(t <= 0) return;
        window.attr.stamina += t * 2.0; window.attr.health += t * 0.5;
        addTip(`å®Œæˆ ${msg}ï¼Œä½“é­„æ„ˆå‘å¼ºå¥ã€‚`);
        updateDisplay();
    }

    function eat(val, msg) { window.attr.health += val; addTip(msg); updateDisplay(); }
    function daily(type, gain, msg) { window.attr[type] += gain; addTip(msg); updateDisplay(); }

    function saveData() {
        const data = { attr: window.attr, goal: window.goal, ach: window.achievements };
        localStorage.setItem('slytherin_complete', JSON.stringify(data));
        addTip('è¿›åº¦å·²é•Œåˆ»åœ¨å®æˆ˜æŒ‡å—ä¸­ã€‚');
    }

    window.onload = () => {
        const saved = localStorage.getItem('slytherin_complete');
        if (saved) {
            const data = JSON.parse(saved);
            window.attr = data.attr; window.goal = data.goal; window.achievements = data.ach || {};
            if(window.achievements.chinese) document.getElementById('chineseGoalCard').classList.add('completed');
            if(window.achievements.western) document.getElementById('westernGoalCard').classList.add('completed');
        }
        updateDisplay();
    };
</script>
</body>
</html>